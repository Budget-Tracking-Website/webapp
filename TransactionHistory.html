<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Transaction History</title>

<!-- Include the jsPDF library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.3/jspdf.umd.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/1.3.2/jspdf.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.16.9/xlsx.full.min.js"></script>
<!-- Include html2canvas library -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/0.4.1/html2canvas.min.js"></script>


<style>
    /* Your CSS styles here */
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: #f4f4f4;
    }
    .container {
        max-width: 600px;
        margin: 20px auto;
        padding: 20px;
        background-color: #fff;
        border-radius: 5px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }
    #top {
        background-color: #999;
    }
    h1 {
        text-align: center;
        margin-bottom: 20px;
    }
    ul {
        list-style-type: none;
        padding: 0;
    }
    li {
        border-bottom: 1px solid #eee;
        padding: 10px 0;
    }
    .transaction {
        display: flex;
        justify-content: space-between;
        align-items: center;
    }
    .monthlyTransaction {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background-color: #f4f4f4; /* Light gray background color */
        padding: 10px;
        /* margin-bottom: 1px; */
        border-radius: 5px;
    }
    .amount {
        font-weight: bold;
    }
    .date {
        color: #999;
    }
    .positive-amount {
        color: green;
    }
    /* css for export button */

    /* Your CSS styles here */
    .button-container {
        display: flex;
        justify-content: center;
        margin-top: 20px;
    }

    .button {
        padding: 10px 20px;
        background-color: rgb(58, 61, 62);
        color: #fff;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }

    .button:hover {
        background-color: #0056b3;
    }

    .button + .button {
        margin-left: 20%; /* Set the distance between buttons here */
    }

</style>

</head>
<body>
    <header class="container" id="top">
        <h1>Transaction History</h1>    

        <div class="button-container">
            <button id="export-button" class="button">Export as EXCEL</button>
            <button id="analysis-button" class="button" onclick = "window.location.href = 'analysis.html';">Transaction Analysis</button>

        </div>
    </header>


<div class="container">
    <ul id="transaction-list">
        <!-- Transactions will be added here -->
    </ul>
</div>

<!-- <div id="analysis-container" class="container" style="display: none;">
    <h1>Transaction Analysis</h1>
    <p>Analysis content goes here...</p>
</div> -->


<script src="transactions.js"></script>
<script>
    // Iterate over the transactions array and create list items
    const transactionList = document.getElementById('transaction-list');
    sortedMonths.forEach(month => {
        const transactionsInMonth = transactionsByMonth[month].transactions;
        const totalAmount = transactionsByMonth[month].total;
        const monthName = new Date(`${month}-01`).toLocaleString('default', { month: 'long', year: 'numeric' });
        const liMonth = document.createElement('li');
        liMonth.innerHTML = `
            <div class="monthlyTransaction">
                <div>
                    <span>${monthName}</span>
                </div>
                <div class="total">${totalAmount.toFixed(2)}</div>
            </div>
        `;
        transactionList.appendChild(liMonth);
        transactionsInMonth.forEach(transaction => {
            const li = document.createElement('li');
            const amountClass = transaction.amount < 0 ? 'negative-amount' : 'positive-amount';
            li.innerHTML = `
                <div class="transaction">
                    <div>
                        <strong>${transaction.merchant}</strong> [${transaction.category}]<br>
                        ${transaction.description}
                    </div>
                    <div class="amount ${amountClass}">${transaction.amount.toFixed(2)}</div>
                </div>
                <div class="date">${transaction.date}</div>
            `;
            transactionList.appendChild(li);
        });
    });

    // Export as PDF functionality
    // const exportButton = document.getElementById('export-button');
    //     exportButton.addEventListener('click', () => {
    //         const pdf = new jsPDF();
    //         pdf.text('Transaction History', 10, 10);
            
    //         let y = 20;
    //         transactions.forEach(transaction => {
    //             const { merchant, description, amount, date } = transaction;
    //             const formattedDate = new Date(date).toLocaleString();
    //             const amountColor = amount < 0 ? 'red' : 'green';
    //             pdf.text(`${merchant}: ${description} - ${amount.toFixed(2)} - ${formattedDate}`, 10, y);
    //             y += 10;
    //         });
    //         pdf.save('transaction-history.pdf');
    //     });
    document.getElementById('export-button').addEventListener('click', function () {
        const wb = XLSX.utils.book_new();
        const ws = XLSX.utils.json_to_sheet(transactions);
        XLSX.utils.book_append_sheet(wb, ws, 'Transactions');
        XLSX.writeFile(wb, 'transactions.xlsx');
    });

</script>
</body>
</html>
